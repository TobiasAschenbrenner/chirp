<section class="singlePost">
  <p *ngIf="loading()">Loadingâ€¦</p>
  <p *ngIf="error()" class="error">{{ error() }}</p>

  <ng-container *ngIf="post() as p">
    <a
      class="singlePost__author feed__header"
      *ngIf="authorId() as uid"
      [routerLink]="['/users', uid]"
      aria-label="Open profile"
    >
      <app-profile-image
        *ngIf="creator()?.profilePhoto"
        [src]="creator()!.profilePhoto"
        size="sm"
      ></app-profile-image>

      <div class="feed__header-details">
        <h4>{{ creator()?.fullName || 'User' }}</h4>
        <small>{{ p.createdAt | timeAgo }}</small>
      </div>
    </a>

    <div class="feed__body">
      <p>{{ p.body }}</p>
      <div class="feed__images">
        <img *ngIf="p.image" [src]="p.image" alt="Post image" />
      </div>
    </div>

    <footer class="feed__footer">
      <div class="feed__footer-left">
        <button type="button" class="feed__action" aria-label="Comments">
          <mat-icon>chat_bubble_outline</mat-icon>
          <small>{{ comments().length }}</small>
        </button>
      </div>

      <div class="feed__footer-right">
        <app-bookmark-post
          [postId]="p._id"
          [initialBookmarked]="usersApi.isBookmarked(p._id)"
        ></app-bookmark-post>
      </div>
    </footer>

    <ul class="singlePost__comments">
      <form class="singlePost__comments-form" (ngSubmit)="createComment()">
        <textarea
          placeholder="Enter your comment..."
          name="comment"
          [ngModel]="commentText()"
          (ngModelChange)="commentText.set($event)"
        ></textarea>

        <button class="singlePost__comments-btn" type="submit" aria-label="Send">
          <mat-icon>send</mat-icon>
        </button>
      </form>

      <app-post-comment
        *ngFor="let c of comments()"
        [comment]="c"
        (delete)="deleteComment($event)"
      ></app-post-comment>
    </ul>
  </ng-container>
</section>
